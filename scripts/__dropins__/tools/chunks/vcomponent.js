var xe=Object.defineProperty;var je=(e,t,r)=>t in e?xe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var ie=(e,t,r)=>je(e,typeof t!="symbol"?t+"":t,r);import{g as Ae}from"./image-params-keymap.js";import{jsx as S}from"../preact-jsx-runtime.js";import{l as v,_ as ye,k as q,G as Me,B as ae}from"./icons/Add.js";import{signal as se}from"../signals.js";const Se=e=>e.reduce((r,n)=>{if(!n)return r;if(typeof n=="string"&&(r+=` ${n}`),Array.isArray(n)){const[a,p]=n;a&&p&&(r+=` ${a}`)}return r},"").trim();function Ee(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var $e=function(t){return Ce(t)&&!Ne(t)};function Ce(e){return!!e&&typeof e=="object"}function Ne(e){var t=Object.prototype.toString.call(e);return t==="[object RegExp]"||t==="[object Date]"||De(e)}var Pe=typeof Symbol=="function"&&Symbol.for,Te=Pe?Symbol.for("react.element"):60103;function De(e){return e.$$typeof===Te}function Fe(e){return Array.isArray(e)?[]:{}}function z(e,t){return t.clone!==!1&&t.isMergeableObject(e)?F(Fe(e),e,t):e}function Le(e,t,r){return e.concat(t).map(function(n){return z(n,r)})}function Ue(e,t){if(!t.customMerge)return F;var r=t.customMerge(e);return typeof r=="function"?r:F}function ke(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return Object.propertyIsEnumerable.call(e,t)}):[]}function le(e){return Object.keys(e).concat(ke(e))}function ge(e,t){try{return t in e}catch{return!1}}function qe(e,t){return ge(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))}function ze(e,t,r){var n={};return r.isMergeableObject(e)&&le(e).forEach(function(a){n[a]=z(e[a],r)}),le(t).forEach(function(a){qe(e,a)||(ge(e,a)&&r.isMergeableObject(t[a])?n[a]=Ue(a,r)(e[a],t[a],r):n[a]=z(t[a],r))}),n}function F(e,t,r){r=r||{},r.arrayMerge=r.arrayMerge||Le,r.isMergeableObject=r.isMergeableObject||$e,r.cloneUnlessOtherwiseSpecified=z;var n=Array.isArray(t),a=Array.isArray(e),p=n===a;return p?n?r.arrayMerge(e,t,r):ze(e,t,r):z(t,r)}F.all=function(t,r){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(n,a){return F(n,a,r)},{})};var Ve=F,We=Ve;const nt=Ee(We),it=(e,t)=>{let r;return function(...n){clearTimeout(r),r=setTimeout(()=>e.apply(this,n),t)}},oe={medium:768,large:1024,xlarge:1366,xxlarge:1920},Ke=(e,t)=>{const[r,n]=e.split("?"),a=new URLSearchParams(n),p=Ae();let _={};return p&&Object.keys(p).length>0&&t?_=Object.entries(t).reduce((f,[g,h])=>{const w=p[g];return w&&(f[w]=h),f},{}):_={auto:"webp",quality:80,crop:!1,fit:"cover",...t},Object.entries(_).forEach(([f,g])=>{g!=null&&a.set(f,String(g))}),`${r}?${a.toString()}`},at=(e,t)=>{if(!e||!(t!=null&&t.width))return;const r=n=>Ke(e,{...n});return Object.entries(oe).map(([,n])=>{const a=t.width*n/oe.xxlarge;return`${r({...t,width:a})} ${n}w`}).join(`,
`)};var Ze=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|^--/i,he=/^(area|base|br|col|embed|hr|img|input|link|meta|param|source|track|wbr)$/,K=/[\s\n\\/='"\0<>]/,be=/^xlink:?./,Be=/["&<]/;function k(e){if(Be.test(e+="")===!1)return e;for(var t=0,r=0,n="",a="";r<e.length;r++){switch(e.charCodeAt(r)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 60:a="&lt;";break;default:continue}r!==t&&(n+=e.slice(t,r)),n+=a,t=r+1}return r!==t&&(n+=e.slice(t,r)),n}var ce=function(e,t){return String(e).replace(/(\n+)/g,"$1"+(t||"	"))},fe=function(e,t,r){return String(e).length>40||String(e).indexOf(`
`)!==-1||String(e).indexOf("<")!==-1},ue={},Ge=/([A-Z])/g;function me(e){var t="";for(var r in e){var n=e[r];n!=null&&n!==""&&(t&&(t+=" "),t+=r[0]=="-"?r:ue[r]||(ue[r]=r.replace(Ge,"-$1").toLowerCase()),t=typeof n=="number"&&Ze.test(r)===!1?t+": "+n+"px;":t+": "+n+";")}return t||void 0}function ee(e,t){return Array.isArray(t)?t.reduce(ee,e):t!=null&&t!==!1&&e.push(t),e}function de(){this.__d=!0}function we(e,t){return{__v:e,context:t,props:e.props,setState:de,forceUpdate:de,__d:!0,__h:[]}}function Z(e,t){var r=e.contextType,n=r&&t[r.__c];return r!=null?n?n.props.value:r.__:t}var I=[];function L(e,t,r,n,a,p){if(e==null||typeof e=="boolean")return"";if(typeof e!="object")return typeof e=="function"?"":k(e);var _=r.pretty,f=_&&typeof _=="string"?_:"	";if(Array.isArray(e)){for(var g="",h=0;h<e.length;h++)_&&h>0&&(g+=`
`),g+=L(e[h],t,r,n,a,p);return g}if(e.constructor!==void 0)return"";var w,u=e.type,o=e.props,x=!1;if(typeof u=="function"){if(x=!0,!r.shallow||!n&&r.renderRootComponent!==!1){if(u===q){var m=[];return ee(m,e.props.children),L(m,t,r,r.shallowHighOrder!==!1,a,p)}var y,i=e.__c=we(e,t);v.__b&&v.__b(e);var P=v.__r;if(u.prototype&&typeof u.prototype.render=="function"){var E=Z(u,t);(i=e.__c=new u(o,E)).__v=e,i._dirty=i.__d=!0,i.props=o,i.state==null&&(i.state={}),i._nextState==null&&i.__s==null&&(i._nextState=i.__s=i.state),i.context=E,u.getDerivedStateFromProps?i.state=Object.assign({},i.state,u.getDerivedStateFromProps(i.props,i.state)):i.componentWillMount&&(i.componentWillMount(),i.state=i._nextState!==i.state?i._nextState:i.__s!==i.state?i.__s:i.state),P&&P(e),y=i.render(i.props,i.state,i.context)}else for(var C=Z(u,t),T=0;i.__d&&T++<25;)i.__d=!1,P&&P(e),y=u.call(e.__c,o,C);return i.getChildContext&&(t=Object.assign({},t,i.getChildContext())),v.diffed&&v.diffed(e),L(y,t,r,r.shallowHighOrder!==!1,a,p)}u=(w=u).displayName||w!==Function&&w.name||function(J){var Q=(Function.prototype.toString.call(J).match(/^\s*function\s+([^( ]+)/)||"")[1];if(!Q){for(var W=-1,R=I.length;R--;)if(I[R]===J){W=R;break}W<0&&(W=I.push(J)-1),Q="UnnamedComponent"+W}return Q}(w)}var j,O,d="<"+u;if(o){var b=Object.keys(o);r&&r.sortAttributes===!0&&b.sort();for(var $=0;$<b.length;$++){var s=b[$],c=o[s];if(s!=="children"){if(!K.test(s)&&(r&&r.allAttributes||s!=="key"&&s!=="ref"&&s!=="__self"&&s!=="__source")){if(s==="defaultValue")s="value";else if(s==="defaultChecked")s="checked";else if(s==="defaultSelected")s="selected";else if(s==="className"){if(o.class!==void 0)continue;s="class"}else a&&be.test(s)&&(s=s.toLowerCase().replace(/^xlink:?/,"xlink:"));if(s==="htmlFor"){if(o.for)continue;s="for"}s==="style"&&c&&typeof c=="object"&&(c=me(c)),s[0]==="a"&&s[1]==="r"&&typeof c=="boolean"&&(c=String(c));var l=r.attributeHook&&r.attributeHook(s,c,t,r,x);if(l||l==="")d+=l;else if(s==="dangerouslySetInnerHTML")O=c&&c.__html;else if(u==="textarea"&&s==="value")j=c;else if((c||c===0||c==="")&&typeof c!="function"){if(!(c!==!0&&c!==""||(c=s,r&&r.xml))){d=d+" "+s;continue}if(s==="value"){if(u==="select"){p=c;continue}u==="option"&&p==c&&o.selected===void 0&&(d+=" selected")}d=d+" "+s+'="'+k(c)+'"'}}}else j=c}}if(_){var A=d.replace(/\n\s*/," ");A===d||~A.indexOf(`
`)?_&&~d.indexOf(`
`)&&(d+=`
`):d=A}if(d+=">",K.test(u))throw new Error(u+" is not a valid HTML tag name in "+d);var D,Oe=he.test(u)||r.voidElements&&r.voidElements.test(u),M=[];if(O)_&&fe(O)&&(O=`
`+f+ce(O,f)),d+=O;else if(j!=null&&ee(D=[],j).length){for(var B=_&&~d.indexOf(`
`),re=!1,G=0;G<D.length;G++){var X=D[G];if(X!=null&&X!==!1){var N=L(X,t,r,!0,u==="svg"||u!=="foreignObject"&&a,p);if(_&&!B&&fe(N)&&(B=!0),N)if(_){var ne=N.length>0&&N[0]!="<";re&&ne?M[M.length-1]+=N:M.push(N),re=ne}else M.push(N)}}if(_&&B)for(var Y=M.length;Y--;)M[Y]=`
`+f+ce(M[Y],f)}if(M.length||O)d+=M.join("");else if(r&&r.xml)return d.substring(0,d.length-1)+" />";return!Oe||D||O?(_&&~d.indexOf(`
`)&&(d+=`
`),d=d+"</"+u+">"):d=d.replace(/>$/," />"),d}var Xe={shallow:!0};V.render=V;var Ye=function(e,t){return V(e,t,Xe)},pe=[];function V(e,t,r){t=t||{};var n=v.__s;v.__s=!0;var a,p=ye(q,null);return p.__k=[e],a=r&&(r.pretty||r.voidElements||r.sortAttributes||r.shallow||r.allAttributes||r.xml||r.attributeHook)?L(e,t,r):U(e,t,!1,void 0,p),v.__c&&v.__c(e,pe),v.__s=n,pe.length=0,a}function H(e){return e==null||typeof e=="boolean"?null:typeof e=="string"||typeof e=="number"||typeof e=="bigint"?ye(null,null,e):e}function Je(e,t){return e==="className"?"class":e==="htmlFor"?"for":e==="defaultValue"?"value":e==="defaultChecked"?"checked":e==="defaultSelected"?"selected":t&&be.test(e)?e.toLowerCase().replace(/^xlink:?/,"xlink:"):e}function Qe(e,t){return e==="style"&&t!=null&&typeof t=="object"?me(t):e[0]==="a"&&e[1]==="r"&&typeof t=="boolean"?String(t):t}var _e=Array.isArray,ve=Object.assign;function U(e,t,r,n,a){if(e==null||e===!0||e===!1||e==="")return"";if(typeof e!="object")return typeof e=="function"?"":k(e);if(_e(e)){var p="";a.__k=e;for(var _=0;_<e.length;_++)p+=U(e[_],t,r,n,a),e[_]=H(e[_]);return p}if(e.constructor!==void 0)return"";e.__=a,v.__b&&v.__b(e);var f=e.type,g=e.props;if(typeof f=="function"){var h;if(f===q)h=g.children;else{h=f.prototype&&typeof f.prototype.render=="function"?function(b,$){var s=b.type,c=Z(s,$),l=new s(b.props,c);b.__c=l,l.__v=b,l.__d=!0,l.props=b.props,l.state==null&&(l.state={}),l.__s==null&&(l.__s=l.state),l.context=c,s.getDerivedStateFromProps?l.state=ve({},l.state,s.getDerivedStateFromProps(l.props,l.state)):l.componentWillMount&&(l.componentWillMount(),l.state=l.__s!==l.state?l.__s:l.state);var A=v.__r;return A&&A(b),l.render(l.props,l.state,l.context)}(e,t):function(b,$){var s,c=we(b,$),l=Z(b.type,$);b.__c=c;for(var A=v.__r,D=0;c.__d&&D++<25;)c.__d=!1,A&&A(b),s=b.type.call(c,b.props,l);return s}(e,t);var w=e.__c;w.getChildContext&&(t=ve({},t,w.getChildContext()))}var u=U(h=h!=null&&h.type===q&&h.key==null?h.props.children:h,t,r,n,e);return v.diffed&&v.diffed(e),e.__=void 0,v.unmount&&v.unmount(e),u}var o,x,m="<";if(m+=f,g)for(var y in o=g.children,g){var i=g[y];if(!(y==="key"||y==="ref"||y==="__self"||y==="__source"||y==="children"||y==="className"&&"class"in g||y==="htmlFor"&&"for"in g||K.test(y))){if(i=Qe(y=Je(y,r),i),y==="dangerouslySetInnerHTML")x=i&&i.__html;else if(f==="textarea"&&y==="value")o=i;else if((i||i===0||i==="")&&typeof i!="function"){if(i===!0||i===""){i=y,m=m+" "+y;continue}if(y==="value"){if(f==="select"){n=i;continue}f!=="option"||n!=i||"selected"in g||(m+=" selected")}m=m+" "+y+'="'+k(i)+'"'}}}var P=m;if(m+=">",K.test(f))throw new Error(f+" is not a valid HTML tag name in "+m);var E="",C=!1;if(x)E+=x,C=!0;else if(typeof o=="string")E+=k(o),C=!0;else if(_e(o)){e.__k=o;for(var T=0;T<o.length;T++){var j=o[T];if(o[T]=H(j),j!=null&&j!==!1){var O=U(j,t,f==="svg"||f!=="foreignObject"&&r,n,e);O&&(E+=O,C=!0)}}}else if(o!=null&&o!==!1&&o!==!0){e.__k=[H(o)];var d=U(o,t,f==="svg"||f!=="foreignObject"&&r,n,e);d&&(E+=d,C=!0)}if(v.diffed&&v.diffed(e),e.__=void 0,v.unmount&&v.unmount(e),C)m+=E;else if(he.test(f))return P+" />";return m+"</"+f+">"}V.shallowRender=Ye;const Re=Me(null);class st{constructor(t){ie(this,"_provider");this._provider=t}render(t,r){return async n=>{var u;if(!t)throw new Error("Component is not defined");if(!n)throw new Error("Root element is not defined");const a=await((u=t.getInitialData)==null?void 0:u.call(t,r))??{},p=se({...r}),_=se(new Set),f=this._provider,g=({next:o})=>S(Re.Provider,{value:_,children:S(te,{node:f,...f.props,children:S(t,{...o.value,initialData:a})})}),h=document.createElement("div");ae(S(g,{next:p}),h);const w={remove:()=>{ae(null,h)},setProps:o=>{const x=o(p.peek());p.value=x}};return new Promise(o=>{_.subscribe(x=>{if(x.size===0)return h.firstChild&&(n.classList.add("dropin-design"),n.innerHTML="",n.appendChild(h.firstChild)),o(w)})})}}unmount(t){var r;if(!t)throw new Error("Root element is not defined");(r=t.firstChild)==null||r.remove()}async toString(t,r,n){var p;if(!t)throw new Error("Component is not defined");const a=await((p=t.getInitialData)==null?void 0:p.call(t,r))??{};return V(S(te,{node:this._provider,...this._provider.props,children:S(t,{...r,initialData:a})}),{},{...n})}}function te({node:e,...t}){return e?Array.isArray(e)?S(q,{children:e.map((r,n)=>S(te,{node:r,className:t.className,...t},n))}):(t.className=Se([e.props.className,t.className]),S(e.type,{ref:e.ref,...e.props,...t},e.key)):null}export{st as R,Re as S,te as V,it as a,Se as c,nt as d,at as g};
