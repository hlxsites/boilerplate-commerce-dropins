import{jsx as r,jsxs as C}from"@dropins/tools/preact-jsx-runtime.js";import{Button as a,Card as S,Header as l}from"@dropins/tools/components.js";import"../chunks/OrderLoaders.js";import{Slot as p,classes as h}from"@dropins/tools/lib.js";import{useText as A}from"@dropins/tools/i18n.js";import{useState as T,useEffect as R,useMemo as E}from"@dropins/tools/preact-hooks.js";import{S as u,C as x}from"../chunks/OrderLoaders2.js";import{events as _}from"@dropins/tools/event-bus.js";import"@dropins/tools/preact-compat.js";const O=({title:e,description:t,children:i})=>C(S,{className:"dropin-order-status-content",variant:"secondary",children:[r(l,{title:e}),C("div",{className:"dropin-order-status-content__wrapper",children:[r("div",{className:"dropin-order-status-content__wrapper-description",children:r("p",{children:t})}),i]})]}),y=({slots:e,title:t,status:i})=>{const d=A({orderOnHold:"Order.OrderStatusContent.orderOnHold.mainText",orderShippend:"Order.OrderStatusContent.orderShippend.mainText",orderReceived:"Order.OrderStatusContent.orderReceived.mainText",orderComplete:"Order.OrderStatusContent.orderComplete.mainText",orderCanceled:"Order.OrderStatusContent.orderCanceled.mainText",orderOnHoldTitle:"Order.OrderStatusContent.orderOnHold.title",orderShippendTitle:"Order.OrderStatusContent.orderShippend.title",orderReceivedTitle:"Order.OrderStatusContent.orderReceived.title",orderCompleteTitle:"Order.OrderStatusContent.orderComplete.title",orderCanceledTitle:"Order.OrderStatusContent.orderCanceled.title"}),n={1:r(O,{title:t??d.orderCanceledTitle,description:d.orderCanceled,children:e!=null&&e.OrderCanceledActions?r(p,{"data-testid":"orderCanceledActions",name:"OrderCanceledActions",slot:e==null?void 0:e.OrderCanceledActions,context:{}}):r("div",{})}),2:r(O,{title:t??d.orderOnHoldTitle,description:d.orderOnHold,children:e!=null&&e.OrderOnHoldActions?r(p,{"data-testid":"orderOnHoldActions",name:"OrderOnHoldActions",slot:e==null?void 0:e.OrderOnHoldActions,context:{}}):r("div",{})}),3:r(O,{title:t??d.orderCompleteTitle,description:d.orderComplete,children:e!=null&&e.OrderCompletedActions?r(p,{"data-testid":"orderCompletedActions",name:"OrderCompletedActions",slot:e==null?void 0:e.OrderCompletedActions,context:{}}):r("div",{className:h(["dropin-order-status-content__wrapper-actions"]),children:r(a,{type:"button",variant:"secondary",children:"Return or replace"})})}),4:r(O,{title:t??d.orderReceivedTitle,description:d.orderReceived,children:e!=null&&e.OrderReceivedActions?r(p,{"data-testid":"orderReceivedActions",name:"OrderReceivedActions",slot:e==null?void 0:e.OrderReceivedActions,context:{}}):C("div",{className:h(["dropin-order-status-content__wrapper-actions"]),children:[r(a,{type:"button",variant:"secondary",children:"Edit order"}),r(a,{type:"button",variant:"secondary",children:"Cancel order"})]})}),5:r(O,{title:t??d.orderShippendTitle,description:d.orderShippend,children:e!=null&&e.OrderShippedActions?r(p,{"data-testid":"orderShippedActions",name:"OrderShippedActions",slot:e==null?void 0:e.OrderShippedActions,context:{}}):r("div",{className:h(["dropin-order-status-content__wrapper-actions"]),children:r(a,{type:"button",variant:"secondary",children:"Return or replace"})})}),6:C("div",{children:[r(O,{title:t??d.orderReceivedTitle,description:d.orderReceived,children:e!=null&&e.OrderReceivedActions?r(p,{"data-testid":"orderReceivedActions",name:"OrderReceivedActions",slot:e==null?void 0:e.OrderReceivedActions,context:{}}):C("div",{className:h(["dropin-order-status-content__wrapper-actions"]),children:[r(a,{type:"button",variant:"secondary",children:"Edit order"}),r(a,{type:"button",variant:"secondary",children:"Cancel order"})]})}),r(O,{title:t??d.orderShippendTitle,description:d.orderShippend,children:e!=null&&e.OrderShippedActions?r(p,{"data-testid":"orderShippedActions",name:"OrderShippedActions",slot:e==null?void 0:e.OrderShippedActions,context:{}}):r("div",{className:h(["dropin-order-status-content__wrapper-actions"]),children:r(a,{type:"button",variant:"secondary",children:"Return or replace"})})})]})};return i?r("div",{children:n[i]}):r("div",{})},f=({orderData:e})=>{const[t,i]=T(e);return R(()=>{_.on("order/data",n=>{i(n)},{eager:!0})},[]),{orderStatus:E(()=>{if(!t)return 0;const{status:n,availableActions:c,shipments:o}=t,m=[{check:n===u.CANCELED,value:1},{check:[u.HOLD,u.SUSPECTED_FRAUD,u.PAYMENT_REVIEW].includes(n),value:2},{check:n===u.COMPLETE,value:3},{check:(o==null?void 0:o.length)>0&&n!==u.COMPLETE&&(c==null?void 0:c.includes("CANCEL")),value:6},{check:c==null?void 0:c.includes("CANCEL"),value:4},{check:(o==null?void 0:o.length)>0&&n!==u.COMPLETE,value:5}].find(v=>v.check);return m?m.value:0},[t]),order:t}},g=({slots:e,orderData:t,className:i,statusTitle:d,status:n})=>{const{orderStatus:c,order:o}=f({orderData:t});return r("div",{className:h(["dropin-order-status",i]),children:o?r(y,{title:d,status:n||c,slots:e}):r(x,{withCard:!1})})};export{g as OrderStatus,g as default};
