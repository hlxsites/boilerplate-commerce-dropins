import{jsxs as l,jsx as e}from"@dropins/tools/preact-jsx-runtime.js";import{classes as R}from"@dropins/tools/lib.js";import"@dropins/tools/event-bus.js";import"@dropins/tools/recaptcha.js";import{r as b}from"./requestPasswordResetEmail.js";import{g,c as w,u as _,T as p,F as x,B as y,S as N}from"./useInLineAlert.js";import{useState as T,useCallback as F}from"@dropins/tools/preact-hooks.js";import{useText as P}from"@dropins/tools/i18n.js";import{InLineAlert as h}from"@dropins/tools/components.js";import{s as E,D as v}from"./simplifyTransformAttributesForm.js";const D=({routeSignIn:i,onErrorCallback:a,setActiveComponent:r,handleSetInLineAlertProps:s})=>{const c=P({successPasswordResetEmailNotification:"Auth.Notification.successPasswordResetEmailNotification"}),[m,t]=T(!1),d=F(async n=>{n.preventDefault(),t(!0);const o=g(n.target);if(o&&o.email){const f=await b(o.email);f.success?s==null||s({type:"success",text:c.successPasswordResetEmailNotification.replace("{email}",o.email)}):(a==null||a(f),s==null||s({type:"error",text:f.message}))}t(!1)},[s,a,c.successPasswordResetEmailNotification]),u=F(()=>{if(w(r)){r("signInForm");return}w(i)&&(window.location.href=i())},[r,i]);return{isLoading:m,submitResetPassword:d,redirectToSignInPage:u}},A=({formSize:i="default",routeSignIn:a,setActiveComponent:r,onErrorCallback:s,...c})=>{const m=P({title:"Auth.ResetPasswordForm.title",buttonPrimary:"Auth.ResetPasswordForm.buttonPrimary",buttonSecondary:"Auth.ResetPasswordForm.buttonSecondary"}),{inLineAlertProps:t,handleSetInLineAlertProps:d}=_(),{isLoading:u,submitResetPassword:n,redirectToSignInPage:o}=D({routeSignIn:a,setActiveComponent:r,onErrorCallback:s,handleSetInLineAlertProps:d});return l("div",{...c,className:R(["auth-resetPasswordForm",i]),"data-testid":"resetPasswordForm",children:[e(p,{text:m.title,bottomLine:!1,className:"auth-resetPasswordForm__title"}),t.text?e(h,{className:"auth-resetPasswordForm__notification",type:t.type,variant:"secondary",heading:t.text,icon:t.icon}):null,e(x,{name:"resetPassword_form",className:"auth-resetPasswordForm__form",submitCallback:n,isLoading:u,fieldsConfig:E(v),children:l("div",{className:"auth-resetPasswordForm__buttons",children:[e(y,{type:"button",variant:"tertiary",style:{padding:"0"},icon:e(N,{style:{transform:"rotate(90deg)"}}),buttonText:m.buttonSecondary,enableLoader:!1,onClick:o}),e(y,{type:"submit",buttonText:m.buttonPrimary,variant:"primary",enableLoader:u})]})}),e("div",{id:"requestPasswordResetEmail"})]})};export{A as R};
