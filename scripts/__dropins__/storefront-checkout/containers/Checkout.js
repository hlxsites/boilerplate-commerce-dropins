import{jsx as r,jsxs as k,Fragment as R}from"@dropins/tools/preact-jsx-runtime.js";import{o as q,n as z,m as L,k as G,U as J}from"../chunks/fixtures.js";import"@dropins/tools/event-bus.js";import{a as Q}from"../chunks/getCustomer.js";import{p as W}from"../chunks/placeOrder2.js";import{C as h}from"../chunks/ToggleButton.js";import"@dropins/tools/preact-hooks.js";import{Slot as d,classes as c}from"@dropins/tools/lib.js";import{Divider as X,IllustratedMessage as _,Icon as M,Button as y}from"@dropins/tools/components.js";/* empty css                             */import{useText as f,MarkupText as Y}from"@dropins/tools/i18n.js";import{B as D}from"../chunks/BillToShippingAddress2.js";import{B as ee}from"../chunks/BillingForm.js";import*as t from"@dropins/tools/preact-compat.js";import{useState as g,useCallback as re}from"@dropins/tools/preact-compat.js";import{L as te}from"../chunks/LoginForm.js";import{P as oe}from"../chunks/ToggleButton2.js";import{P as ne}from"../chunks/PlaceOrder.js";import{S as ie}from"../chunks/ShippingForm.js";import{S as se}from"../chunks/ShippingMethods.js";import"@dropins/tools/preact.js";import"@dropins/tools/fetch-graphql.js";import"../chunks/getCart.graphql.js";import"../chunks/getMultilineValues.js";import"../chunks/ErrorBanner.js";import"../chunks/MergedCartBanner.js";import"../chunks/setBillingAddress.js";import"../chunks/setShippingAddress.js";import"../chunks/constants2.js";import"../chunks/setGuestEmailOnCart.js";import"../chunks/constants3.js";import"../chunks/setPaymentMethod.js";import"../chunks/constants.js";import"../chunks/setShippingMethods.js";const ce=i=>t.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...i},t.createElement("g",{clipPath:"url(#clip0_102_196)"},t.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M18.3601 18.16H6.5601L4.8801 3H2.3501M19.6701 19.59C19.6701 20.3687 19.0388 21 18.2601 21C17.4814 21 16.8501 20.3687 16.8501 19.59C16.8501 18.8113 17.4814 18.18 18.2601 18.18C19.0388 18.18 19.6701 18.8113 19.6701 19.59ZM7.42986 19.59C7.42986 20.3687 6.79858 21 6.01986 21C5.24114 21 4.60986 20.3687 4.60986 19.59C4.60986 18.8113 5.24114 18.18 6.01986 18.18C6.79858 18.18 7.42986 18.8113 7.42986 19.59Z",stroke:"currentColor",strokeLinejoin:"round"}),t.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M5.25 6.37L20.89 8.06L20.14 14.8H6.19",stroke:"currentColor",strokeLinejoin:"round"})),t.createElement("defs",null,t.createElement("clipPath",{id:"clip0_102_196"},t.createElement("rect",{vectorEffect:"non-scaling-stroke",width:19.29,height:19.5,fill:"white",transform:"translate(2.3501 2.25)"})))),ae=i=>t.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...i},t.createElement("g",{clipPath:"url(#clip0_4797_15331)"},t.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M10.25 20.91L1.5 17.55V6.51996L10.25 9.92996V20.91Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),t.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M6.24023 4.64001L14.9902 8.06001V11.42",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),t.createElement("path",{className:"error-icon",vectorEffect:"non-scaling-stroke",d:"M19 13.31L15.5 19.37H22.5L19 13.31Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),t.createElement("path",{className:"error-icon",vectorEffect:"non-scaling-stroke",d:"M19.0202 17.11H18.9802L18.9502 15.56H19.0502L19.0202 17.11ZM18.9602 18.29V18.06H19.0502V18.29H18.9602Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),t.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M19 12.16V6.51996L10.25 9.92996V20.91L14.27 19.37L14.4 19.32",stroke:"currentColor",strokeLinejoin:"round"}),t.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M1.5 6.51999L10.25 3.04999L19 6.51999L10.25 9.92999L1.5 6.51999Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})),t.createElement("defs",null,t.createElement("clipPath",{id:"clip0_4797_15331"},t.createElement("rect",{width:22,height:18.86,fill:"white",transform:"translate(1 2.54999)"})))),Re="OUT_OF_STOCK",qe=i=>{const{className:l,slots:e,routeHome:m,preselectedCartData:o,onSignInClick:a,onSignOutClick:u,...b}=i,w=q.authenticated,[P,O]=g(!1),[E,v]=g(""),B=E!=="",[T,x]=g(),{data:n,pending:F}=z.value,p=!!(n!=null&&n.isVirtual),N=n===null||(n==null?void 0:n.isEmpty),{data:C,pending:j}=L.value,V=F&&w&&!C,A=f({CheckoutUnexpectedError:"Checkout.ServerError.unexpected"}),Z=re(async()=>{n&&(await W(),O(!0))},[n]),U=s=>{x(()=>s)},I=async()=>{v(""),n&&Q()},S=s=>{const K=s instanceof TypeError||s instanceof J?A.CheckoutUnexpectedError:s.message;v(K)};if(P)return null;if(N)return r(le,{routeHome:m});if(B)return r(me,{errorMessage:E,onClick:I});const H=()=>{const s=G.value.checked?"checkout-billing-form__hidden":"checkout-billing-form__visible";return r(h.Main,{sections:{billingAddress:k(R,{children:[r(d,{name:"BillingForm",className:s,slot:e==null?void 0:e.BillingForm,children:r(ee,{})}),r(X,{className:c([`${s}`,"checkout-billing-form__divider"]),variant:"primary"})]}),billToShippingAddress:p?void 0:r(D,{},`bill-to-shipping-address${C?"-customer":""}`),login:r(d,{name:"Login",slot:e==null?void 0:e.Login,children:r(te,{onSignInClick:a,onSignOutClick:()=>{u==null||u(),L.value.pending=!0}})}),paymentMethods:r(oe,{isShippingInfoRequired:!p,onPlaceOrder:U,handleServerError:S,paymentMethodsSlot:e==null?void 0:e.PaymentMethods}),placeOrder:r(ne,{onClick:T??Z,handleServerError:S}),shippingAddress:p?void 0:r(d,{name:"ShippingForm",slot:e==null?void 0:e.ShippingForm,children:r(ie,{preselectedFields:o==null?void 0:o.address})}),shippingMethods:p?void 0:r(d,{name:"ShippingMethods",slot:e==null?void 0:e.ShippingMethods,children:r(se,{preSelectedMethod:o==null?void 0:o.shippingMethod})})}})},$=()=>r(h.Aside,{sections:{orderSummary:r(d,{name:"OrderSummary",slot:e==null?void 0:e.OrderSummary})}});return k(h,{className:l,isLoading:V||j,...b,children:[H(),$()]})},le=({className:i,title:l,routeHome:e,...m})=>{const o=f({Title:"Checkout.EmptyCart.title",Button:"Checkout.EmptyCart.button"});return r(_,{...m,"data-testid":"checkout-empty-cart",className:c(["checkout-empty-cart",i]),heading:l??o.Title,icon:r(M,{className:c(["checkout-empty-cart__icon"]),source:ce}),action:e!=null&&e()?r(y,{className:"checkout-empty-cart__button",size:"medium",variant:"primary",type:"submit",href:e==null?void 0:e(),children:o.Button},"routeHome"):void 0})},me=({className:i,errorMessage:l,contactSupport:e,...m})=>{const{onClick:o}=m,a=f({Title:"Checkout.ServerError.title",Message:"Checkout.ServerError.message",ContactSupport:"Checkout.ServerError.contactSupport",Button:"Checkout.ServerError.button"});return r(_,{"aria-invalid":"true","aria-describedby":"checkout-server-error__message","aria-live":"polite",className:c(["checkout-server-error",i]),"data-testid":"checkout-server-error",heading:l??a.Title,message:k("p",{id:c(["checkout-server-error__message"]),children:[a.Message,r("br",{}),r(Y,{id:"",children:e??a.ContactSupport})]}),icon:r(M,{className:c(["checkout-server-error__icon"]),source:ae}),action:r(y,{className:c(["checkout-server-error__button"]),onClick:o,children:a.Button})})};export{qe as Checkout,Re as OUT_OF_STOCK,qe as default};
