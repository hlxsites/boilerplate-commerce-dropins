import{jsx as n}from"@dropins/tools/preact-jsx-runtime.js";import{classes as l}from"@dropins/tools/lib.js";import"./ToggleButton.js";import{Button as u}from"@dropins/tools/components.js";import{Text as d}from"@dropins/tools/i18n.js";import{events as p}from"@dropins/tools/event-bus.js";import{n as O}from"./fixtures.js";import"@dropins/tools/preact-hooks.js";/* empty css                     */import{useState as h,useEffect as P}from"@dropins/tools/preact-compat.js";import{B as v}from"./constants2.js";import{L as I}from"./constants3.js";import{S as F}from"./constants.js";const S=({className:e,onClick:r=()=>{},disabled:o=!1})=>n("div",{className:l(["checkout-place-order",e]),children:n(u,{className:l(["checkout-place-order__button",e]),"data-testid":"place-order-button",disabled:o,onClick:r,size:"medium",type:"submit",variant:"primary",children:n(d,{id:"Checkout.PlaceOrder.button"})},"placeOrder")}),_=[I,F,v],k=e=>{const r=e.querySelector(":invalid");r&&(r.scrollIntoView({behavior:"smooth"}),r.focus())},y=()=>{const r=(Array.from(document.forms)||[]).filter(t=>_.includes(t.name)).filter(t=>t.offsetParent!==null).filter(t=>!t.checkValidity()),o=r.length===0;if(!o){const t=r[0];k(t)}return o},w=({onClick:e,handleServerError:r})=>{const[o,t]=h(!1),a=O.value.pending,m=async()=>{if(y())try{await e()}catch(i){r(i)}};return P(()=>{const i=p.on("cart/initialized",c=>{const f=(c==null?void 0:c.items)||[];t(f.some(s=>s.outOfStock||s.insufficientQuantity))},{eager:!0});return()=>{i==null||i.off()}},[]),n(S,{onClick:m,disabled:a||o})};export{w as P};
